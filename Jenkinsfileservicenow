 pipeline {
 agent {node {label 'master'}}

 
 stages {
  stage('Checkout') {
   steps {
    checkout([$class: 'GitSCM', branches: [[name: '*/master']], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[credentialsId: '21dcef66-4390-4b26-8345-bdce1adc6a5d', url: 'https://github.com/rohithks/dotnet-project.git']]])
   }
  }
  
  stage('Load Properties') {
  steps {
    load "Jenkinstest1.properties"
  }
  }
	 
   stage('Restore Packages') {
   steps {
     serviceNow_createChange()
     def response = serviceNow_createChange serviceNowConfiguration: [instance: 'dev71406', producerId: 'ls98y3khifs8oih3kjshihksjd'], credentialsId: 'servicenow_id', vaultConfiguration: [url: 'https://dev71406.service-now.com/', path: 'secret/for/service_now/']
     def jsonSlurper = new JsonSlurper()
     def createResponse = jsonSlurper.parseText(response.content)
     def sysId = createResponse.result.sys_id
     def changeNumber = createResponse.result.number
     bat "\"${env.Nuget_Path}\" restore 1-hello-world"
           
    }
   }
   }
  }
 
